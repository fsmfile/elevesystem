SELECT tbl_rot_vendasDetalhadas.Cod_VendasDet, tbl_rot_vendasDetalhadas.Cod_venda, tbl_cad_prodserv.Cod_ProdServ, [tbl_cad_prodserv]![cod_prodserv] & " " & [Nome_prodServ] AS Produto, tbl_rot_vendasDetalhadas.Quantidade_VendasDet, tbl_cad_prodserv.precoVenda_prodserv, tbl_cad_prodserv.MargemMinima_prodServ, tbl_rot_vendasDetalhadas.Valor_unitario_vendasDet, tbl_cad_prodserv.custo_final_prodserv, ([Valor_unitario_vendasDet]/[custo_final_prodserv])-1 AS MargemLucro, [valor_unitario_vendasdet]*[quantidade_vendasDet] AS ValorTotal_porproduto, (([precocusto_prodserv]+[outroscustos_prodserv])*[margemminima_prodserv])+([precocusto_prodserv]+[outroscustos_prodserv]) AS ValorMinimo, tbl_rot_vendasDetalhadas.Largura_prodserv, tbl_rot_vendasDetalhadas.Altura_prodserv, tbl_rot_vendasDetalhadas.cod_grupoProdServ, tbl_cad_prodserv.VendaAbaixoEstoque_prodserv, tbl_cad_prodserv.Localizacao_prodserv, tbl_cad_prodserv.Grupo_prodServ, tbl_rot_vendasDetalhadas.QtdInt_Prodserv, tbl_cad_prodserv.NCM_Prodserv, tbl_cad_prodserv.Unidade_prodserv, IIf([total em estoque]-[Quantidade_VendasDet]>=0,0,IIf([VendaAbaixoEstoque_prodserv]=0,1,0)) AS ValidaEstoque
FROM ((tbl_cad_prodserv RIGHT JOIN tbl_rot_vendasDetalhadas ON tbl_cad_prodserv.Cod_ProdServ = tbl_rot_vendasDetalhadas.Cod_produto) LEFT JOIN (tbl_Prodserv_Promocao LEFT JOIN tbl_ProdServ_promDET ON tbl_Prodserv_Promocao.CodPromocao = tbl_ProdServ_promDET.CodPromocao) ON tbl_rot_vendasDetalhadas.Cod_produto = tbl_Prodserv_Promocao.CodPromocao) LEFT JOIN TMP_Estoque ON tbl_cad_prodserv.Cod_ProdServ = TMP_Estoque.Cod_ProdServ
WHERE (((tbl_rot_vendasDetalhadas.QtdInt_Prodserv)=No))
ORDER BY tbl_rot_vendasDetalhadas.Cod_VendasDet;
