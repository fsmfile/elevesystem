SELECT tbl_rot_vendas.Cod_venda, tbl_rot_vendas.Dt_Hr_venda, tbl_cad_funcionarios.mat_funcionario AS [Matricula Vendedor], tbl_cad_funcionarios.Nome_funcionario AS NomeVendedor, tbl_cad_clientes.Cod_cliente, tbl_cad_clientes.Apelido_cliente, tbl_cad_prodserv.Cod_ProdServ, tbl_cad_prodserv.Nome_prodServ AS DescricaoProd, tbl_rot_vendasDetalhadas.Quantidade_VendasDet, tbl_cad_prodserv.precoVenda_prodserv, [precovenda_prodserv]-([precoVenda_prodserv]*[margemminima_prodserv]) AS ValorMinimo, tbl_rot_vendasDetalhadas.Valor_unitario_vendasDet AS ValorVendido, IIf([ValorVendido]<[ValorMinimo],"Alerta","ok") AS MenorQueValorMinimo, IIf([ValorVendido]<[precoVenda_prodserv],"Alerta","ok") AS MenorQueValorVenda, tbl_rot_vendas.Cod_formaRetiradaEstoque
FROM (((tbl_rot_vendasDetalhadas RIGHT JOIN tbl_rot_vendas ON tbl_rot_vendasDetalhadas.Cod_venda = tbl_rot_vendas.Cod_venda) LEFT JOIN tbl_cad_clientes ON tbl_rot_vendas.Cod_cliente = tbl_cad_clientes.Cod_cliente) LEFT JOIN tbl_cad_prodserv ON tbl_rot_vendasDetalhadas.Cod_produto = tbl_cad_prodserv.Cod_ProdServ) LEFT JOIN tbl_cad_funcionarios ON tbl_rot_vendas.Cod_comissionista_G1 = tbl_cad_funcionarios.mat_funcionario
WHERE (((tbl_rot_vendas.Cod_formaRetiradaEstoque)=1) AND ((tbl_rot_vendas.VendaFinalizada_vendas)=Yes));
