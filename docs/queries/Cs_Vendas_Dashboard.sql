SELECT tbl_rot_vendas.Cod_venda, tbl_cad_prodserv.Cod_ProdServ AS CodProd, tbl_cad_prodserv.Grupo_prodServ, [subgrupo_prodserv] & " " & [nome_prodserv] AS Produto, Sum(tbl_rot_vendasDetalhadas.Quantidade_VendasDet) AS Qtd, DateSerial(Year([Dt_Hr_venda]),Month([Dt_Hr_venda]),Day([Dt_Hr_venda])) AS Data, tbl_rot_vendas.Cod_formaRetiradaEstoque, [nomerazaosocial_cliente] & "/" & [apelido_cliente] & " " & [tipodocumento] & ":" & [cpf_cnpj_cliente] AS Cliente, tbl_cad_funcionarios.Nome_funcionario, tbl_cad_formasPagamento.Nome_FormaPagamento, tbl_cad_formasPagamentoVENDASDET.QtdVezes_venda, tbl_cad_formasPagamentoVENDASDET.Valor_FormaPagVendasDet
FROM (((((tbl_rot_vendasDetalhadas LEFT JOIN tbl_cad_prodserv ON tbl_rot_vendasDetalhadas.Cod_produto = tbl_cad_prodserv.Cod_ProdServ) RIGHT JOIN tbl_rot_vendas ON tbl_rot_vendasDetalhadas.Cod_venda = tbl_rot_vendas.Cod_venda) LEFT JOIN tbl_cad_clientes ON tbl_rot_vendas.Cod_cliente = tbl_cad_clientes.Cod_cliente) LEFT JOIN tbl_cad_funcionarios ON tbl_rot_vendas.Cod_comissionista_G1 = tbl_cad_funcionarios.mat_funcionario) LEFT JOIN tbl_cad_formasPagamentoVENDASDET ON tbl_rot_vendas.Cod_venda = tbl_cad_formasPagamentoVENDASDET.Cod_Venda) LEFT JOIN tbl_cad_formasPagamento ON tbl_cad_formasPagamentoVENDASDET.Cod_formasPagamento = tbl_cad_formasPagamento.Cod_formasPagamento
GROUP BY tbl_rot_vendas.Cod_venda, tbl_cad_prodserv.Cod_ProdServ, tbl_cad_prodserv.Grupo_prodServ, [subgrupo_prodserv] & " " & [nome_prodserv], DateSerial(Year([Dt_Hr_venda]),Month([Dt_Hr_venda]),Day([Dt_Hr_venda])), tbl_rot_vendas.Cod_formaRetiradaEstoque, [nomerazaosocial_cliente] & "/" & [apelido_cliente] & " " & [tipodocumento] & ":" & [cpf_cnpj_cliente], tbl_cad_funcionarios.Nome_funcionario, tbl_cad_formasPagamento.Nome_FormaPagamento, tbl_cad_formasPagamentoVENDASDET.QtdVezes_venda, tbl_cad_formasPagamentoVENDASDET.Valor_FormaPagVendasDet, tbl_rot_vendas.VendaFinalizada_vendas
HAVING (((tbl_cad_prodserv.Cod_ProdServ) Is Not Null) AND ((tbl_rot_vendas.VendaFinalizada_vendas)=Yes));
