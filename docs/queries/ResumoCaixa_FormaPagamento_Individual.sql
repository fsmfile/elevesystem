SELECT Cs_DetalhesFormaPagamento.Nome_FormaPagamento, Sum(Cs_DetalhesFormaPagamento.Valor_FormaPagVendasDet) AS Total, DateSerial(Year([cs_detalhesformapagamento]![Dt_Hr_venda]),Month([cs_detalhesformapagamento]![Dt_Hr_venda]),Day([cs_detalhesformapagamento]![Dt_Hr_venda])) AS DataFiltro, Cs_DetalhesFormaPagamento.Cod_formasPagamento, tbl_rot_vendas.USUARIOLOGADOFECHAMENTO
FROM Cs_DetalhesFormaPagamento LEFT JOIN tbl_rot_vendas ON Cs_DetalhesFormaPagamento.Cod_venda = tbl_rot_vendas.Cod_venda
GROUP BY Cs_DetalhesFormaPagamento.Nome_FormaPagamento, DateSerial(Year([cs_detalhesformapagamento]![Dt_Hr_venda]),Month([cs_detalhesformapagamento]![Dt_Hr_venda]),Day([cs_detalhesformapagamento]![Dt_Hr_venda])), Cs_DetalhesFormaPagamento.Cod_formasPagamento, tbl_rot_vendas.USUARIOLOGADOFECHAMENTO
HAVING (((DateSerial(Year(cs_detalhesformapagamento!Dt_Hr_venda),Month(cs_detalhesformapagamento!Dt_Hr_venda),Day(cs_detalhesformapagamento!Dt_Hr_venda)))=Formulários!frm_saldocaixa_individual!txt_data) And ((Cs_DetalhesFormaPagamento.Cod_formasPagamento)<>CInt(DLookUp("[nomeamigavel]","tbl_cad_clientesFLM","[codcliente_flm]=17")) And (Cs_DetalhesFormaPagamento.Cod_formasPagamento)<>CInt(DLookUp("[nomeamigavel]","tbl_cad_clientesFLM","[codcliente_flm]=18")) And (Cs_DetalhesFormaPagamento.Cod_formasPagamento)<>CInt(DLookUp("[nomeamigavel]","tbl_cad_clientesFLM","[codcliente_flm]=19")) And (Cs_DetalhesFormaPagamento.Cod_formasPagamento)<>CInt(DLookUp("[nomeamigavel]","tbl_cad_clientesFLM","[codcliente_flm]=20")) And (Cs_DetalhesFormaPagamento.Cod_formasPagamento)<>CInt(DLookUp("[nomeamigavel]","tbl_cad_clientesFLM","[codcliente_flm]=21"))) And ((tbl_rot_vendas.USUARIOLOGADOFECHAMENTO) Like "*" & Formulários!frm_saldocaixa_individual!CxUsuario & "*"));
