SELECT DateSerial(Year([Dt_Hr_venda]),Month([Dt_Hr_venda]),Day([Dt_Hr_venda])) AS Dt_Hr_vend, Sum(tbl_cad_formasPagamentoVENDASDET.Valor_FormaPagVendasDet) AS [Valor Entrada], Sum(0) AS [Valor Saída], "Receita" AS Tipo
FROM (tbl_rot_vendas RIGHT JOIN tbl_cad_formasPagamentoVENDASDET ON tbl_rot_vendas.Cod_venda = tbl_cad_formasPagamentoVENDASDET.Cod_Venda) INNER JOIN TMP_formasPagamento ON tbl_cad_formasPagamentoVENDASDET.Cod_formasPagamento = TMP_formasPagamento.Cod_formasPagamento
GROUP BY DateSerial(Year([Dt_Hr_venda]),Month([Dt_Hr_venda]),Day([Dt_Hr_venda])), "Receita", tbl_rot_vendas.Cod_formaRetiradaEstoque, tbl_rot_vendas.VendaFinalizada_vendas, TMP_formasPagamento.Permitido_FormaPagamento
HAVING (((DateSerial(Year([Dt_Hr_venda]),Month([Dt_Hr_venda]),Day([Dt_Hr_venda]))) Between [Formulários]![Frm_totalporvendaporperiodo]![TxtDtInicial] And [Formulários]![Frm_totalporvendaporperiodo]![TxtDtFinal]+1) AND ((tbl_rot_vendas.Cod_formaRetiradaEstoque)=1) AND ((tbl_rot_vendas.VendaFinalizada_vendas)=Yes) AND ((TMP_formasPagamento.Permitido_FormaPagamento)=Yes));
