SELECT tbl_rot_OrdemServico.Cod_OrdemServico, tbl_rot_OrdemServico.DtHr_Abertura_OrdemServico, tbl_rot_OrdemServico.NomeCliente_OrdemServico, tbl_rot_OrdemServico.Cod_Vendas, tbl_cad_veiculos.Placa_veiculo_br, tbl_rot_OrdemServico.Status_OrdemServico, tbl_rot_OrdemServico.Observacao_OrdemServico, tbl_rot_OrdemServico.DtHr_Finalizacao_OrdemServico, tbl_rot_OrdemServico.LocalAtend_OrdemServico, IIf([VendaFinalizada_vendas]=Yes,"Sim","Não") AS Pagamento, tbl_Agenda.DtAgenda, tbl_Agenda.HrInicial_Agenda, IsNull([DtAgenda]) AS TesteAgenda, tbl_cad_funcionarios.mat_funcionario
FROM (tbl_cad_GrupoSistema LEFT JOIN tbl_PermissaoStatusOrdemServico ON tbl_cad_GrupoSistema.cod_grupoUsuario = tbl_PermissaoStatusOrdemServico.Cod_GrupoSistema) LEFT JOIN ((tbl_Agenda LEFT JOIN tbl_cad_funcionarios AS tbl_cad_funcionarios_1 ON tbl_Agenda.Funcionario_Agenda = tbl_cad_funcionarios_1.mat_funcionario) RIGHT JOIN (((((tbl_rot_OrdemServico LEFT JOIN tbl_cad_veiculos ON tbl_rot_OrdemServico.Cod_veiculo = tbl_cad_veiculos.Cod_veiculo) LEFT JOIN tbl_rot_vendas ON tbl_rot_OrdemServico.Cod_Vendas = tbl_rot_vendas.Cod_venda) LEFT JOIN tbl_ComissionistaDaOrdemServico ON tbl_rot_OrdemServico.Cod_OrdemServico = tbl_ComissionistaDaOrdemServico.cod_OrdemServico) LEFT JOIN (tbl_cad_comissionista LEFT JOIN tbl_cad_funcionarios ON tbl_cad_comissionista.Mat_funcionario = tbl_cad_funcionarios.mat_funcionario) ON tbl_ComissionistaDaOrdemServico.Cod_comissionista = tbl_cad_comissionista.Cod_comissionista) LEFT JOIN tbl_Agendamento ON tbl_rot_OrdemServico.Cod_OrdemServico = tbl_Agendamento.Cod_OrdemServico_Agendamento) ON tbl_Agenda.ID = tbl_Agendamento.CodAgenda_agendamento) ON tbl_PermissaoStatusOrdemServico.Cod_StatusOS = tbl_rot_OrdemServico.Status_OrdemServico
WHERE (((tbl_rot_OrdemServico.Status_OrdemServico)<>6 And (tbl_rot_OrdemServico.Status_OrdemServico)<>CInt(DLookUp("[nomeamigavel]","tbl_caD_clientesflm","[codcliente_flm]=22"))) AND ((IsNull([DtAgenda])) Like "*" & [Formulários]![Frm_ControlOrdemServico_PorComissionista]![SelAgendamento] & "*") AND ((tbl_cad_GrupoSistema.Grupo_grupoUsuario)=[Formulários]![Frm_MenuPrinc]![txtPerfilUsuarioLogado]) AND ((tbl_cad_funcionarios.mat_funcionario) Like "*" & [Formulários]![Frm_ControlOrdemServico_PorComissionista]![txtFuncionario] & "*"))
ORDER BY tbl_Agenda.DtAgenda;
