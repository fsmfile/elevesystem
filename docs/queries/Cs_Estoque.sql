SELECT tbl_cad_prodserv.Cod_ProdServ, tbl_cad_prodserv.SubGrupo_prodserv, tbl_cad_prodserv.Nome_prodServ AS Descrição, cs_somaCompras.SomaDeQtdComprada AS ENTRADA, Cs_MovEst_Entradas.ContarDeCodProd_PME_ENTRADA AS Entradas_MovEstoque, Cs_EmprestimoEstoque.EmprestimoEstoque AS Empréstimo, Cs_vendasEstoque.VendasEstoque AS SAÍDAS, Cs_MovEst_Saidas.ContarDeCodProd_PME_SAIDA AS Saidas_MovEstoque, ([SomaDeQtdComprada]+[ContarDeCodProd_PME_ENTRADA])-([vendasestoque]+[ContarDeCodProd_PME_SAIDA]+[emprestimoestoque]) AS [Total em estoque]
FROM ((((Cs_vendasEstoque RIGHT JOIN tbl_cad_prodserv ON Cs_vendasEstoque.Cod_ProdServ = tbl_cad_prodserv.Cod_ProdServ) LEFT JOIN cs_somaCompras ON tbl_cad_prodserv.Cod_ProdServ = cs_somaCompras.Cod_ProdServ) LEFT JOIN Cs_MovEst_Entradas ON tbl_cad_prodserv.Cod_ProdServ = Cs_MovEst_Entradas.Cod_ProdServ) LEFT JOIN Cs_MovEst_Saidas ON tbl_cad_prodserv.Cod_ProdServ = Cs_MovEst_Saidas.Cod_ProdServ) LEFT JOIN Cs_EmprestimoEstoque ON tbl_cad_prodserv.Cod_ProdServ = Cs_EmprestimoEstoque.Cod_ProdServ
GROUP BY tbl_cad_prodserv.Cod_ProdServ, tbl_cad_prodserv.SubGrupo_prodserv, tbl_cad_prodserv.Nome_prodServ, cs_somaCompras.SomaDeQtdComprada, Cs_MovEst_Entradas.ContarDeCodProd_PME_ENTRADA, Cs_EmprestimoEstoque.EmprestimoEstoque, Cs_vendasEstoque.VendasEstoque, Cs_MovEst_Saidas.ContarDeCodProd_PME_SAIDA, ([SomaDeQtdComprada]+[ContarDeCodProd_PME_ENTRADA])-([vendasestoque]+[ContarDeCodProd_PME_SAIDA]+[emprestimoestoque]), tbl_cad_prodserv.Grupo_prodServ, tbl_cad_prodserv.ProdutoAtivo_prodServ
HAVING (((cs_somaCompras.SomaDeQtdComprada) Is Not Null) AND ((tbl_cad_prodserv.Grupo_prodServ)="Produto" Or (tbl_cad_prodserv.Grupo_prodServ)="KIT") AND ((tbl_cad_prodserv.ProdutoAtivo_prodServ)=Yes))
ORDER BY ([SomaDeQtdComprada]+[ContarDeCodProd_PME_ENTRADA])-([vendasestoque]+[ContarDeCodProd_PME_SAIDA]+[emprestimoestoque]);
