SELECT Municípios.codIBGEuf AS ide_cUF, "Venda" AS ide_natOp, 0 AS ide_indPag, 55 AS ide_mod, tbl_rot_vendas.cod_venda AS ide_nNF, tbl_rot_vendas.Dt_Hr_venda AS ide_dhEmi, 1 AS ide_tpNF, 1 AS ide_idDest, Municípios_1.CodIBGEMun AS ide_cMunFG, 1 AS ide_tpImp, 1 AS ide_tpEmis, Nz(DLookUp("[valor]","_parametros","[parametro]='ID_Ambiente_Nfe'"),0) AS ide_tpAmb, 1 AS ide_finNFe, 0 AS ide_indFinal, 0 AS ide_indPres, IIf([tipodocumento]="cpf",[cpf_cnpj_cliente],"") AS dest_CPF, IIf([tipodocumento]="cnpj",[cpf_cnpj_cliente],"") AS dest_CNPJ, tbl_cad_clientes.NomeRazaoSocial_Cliente AS dest_xNome, tbl_cad_clientes.Logradouro_Cliente AS dest_xLgr, tbl_cad_clientes.Numero_cliente AS dest_nro, tbl_cad_clientes.Complemento_cliente AS dest_xCpl, tbl_cad_clientes.Bairro_cliente AS dest_xBairro, Municípios_2.CodIBGEMun AS dest_cMun, Municípios_2.Municipio AS dest_xMun, tbl_cad_clientes.UF_cliente AS dest_UF, tbl_cad_clientes.cep_cliente AS dest_CEP, 1058 AS dest_cPais, tbl_cad_clientes.Pais_cliente AS dest_xPais, tbl_cad_clientes.Telefone_Cliente AS dest_fone, tbl_cad_clientes.InscricaoEstadual_cliente AS dest_IE, tbl_cad_clientes.[E-mail_cliente] AS dest_eMail, tbl_cad_lojas.CNPJ_loja AS retirada_cnpj, tbl_cad_lojas.Endereco_loja AS retirada_xLgr, tbl_cad_lojas.Numero_loja AS retirada_nro, tbl_cad_lojas.Complemento_loja AS retirada_xCpl, tbl_cad_lojas.Bairro_loja AS retirada_xBairro, Municípios_1.CodIBGEMun AS retirada_cMun, Municípios_1.Municipio AS retirada_xMun, tbl_cad_lojas.Estado_loja AS retirada_UF, Cs_TotalPorVenda.Totalporvenda AS TotalICMS_vProd, Cs_TotalPorVenda.Totalporvenda AS TotalICMS_vNF, 9 AS transp_modFrete, 0 AS gerBol, Date() AS dtp, DLookUp("[valor]","_parametros","[parametro]='ID_EMIT'") AS id_emit, 5101 AS ide_CFOP, Yes AS senderp, 2 AS dest_indIEDest, IIf([tipodocumento]="cnpj",2,1) AS stp, tbl_rot_vendas.Cod_venda AS CodMov
FROM (((((tbl_rot_vendas LEFT JOIN tbl_cad_lojas ON tbl_rot_vendas.CNPJ_loja = tbl_cad_lojas.CNPJ_loja) LEFT JOIN Municípios ON tbl_cad_lojas.Estado_loja = Municípios.UF) LEFT JOIN Municípios AS Municípios_1 ON tbl_cad_lojas.Cidade_loja = Municípios_1.Municipio) LEFT JOIN tbl_cad_clientes ON tbl_rot_vendas.Cod_cliente = tbl_cad_clientes.Cod_cliente) LEFT JOIN Municípios AS Municípios_2 ON tbl_cad_clientes.Municipio_cliente = Municípios_2.Municipio) LEFT JOIN Cs_TotalPorVenda ON tbl_rot_vendas.Cod_venda = Cs_TotalPorVenda.Cod_venda
GROUP BY Municípios.codIBGEuf, "Venda", 55, tbl_rot_vendas.cod_venda, tbl_rot_vendas.Dt_Hr_venda, IIf([tipodocumento]="cpf",[cpf_cnpj_cliente],""), IIf([tipodocumento]="cnpj",[cpf_cnpj_cliente],""), tbl_cad_clientes.NomeRazaoSocial_Cliente, tbl_cad_clientes.Logradouro_Cliente, tbl_cad_clientes.Numero_cliente, tbl_cad_clientes.Complemento_cliente, tbl_cad_clientes.Bairro_cliente, Municípios_2.CodIBGEMun, Municípios_2.Municipio, tbl_cad_clientes.UF_cliente, tbl_cad_clientes.cep_cliente, 1058, tbl_cad_clientes.Pais_cliente, tbl_cad_clientes.Telefone_Cliente, tbl_cad_clientes.InscricaoEstadual_cliente, tbl_cad_clientes.[E-mail_cliente], tbl_cad_lojas.CNPJ_loja, tbl_cad_lojas.Endereco_loja, tbl_cad_lojas.Numero_loja, tbl_cad_lojas.Complemento_loja, tbl_cad_lojas.Bairro_loja, Municípios_1.CodIBGEMun, Municípios_1.Municipio, tbl_cad_lojas.Estado_loja, Cs_TotalPorVenda.Totalporvenda, 9, 0, Date(), DLookUp("[valor]","_parametros","[parametro]='ID_EMIT'"), 5101, Yes, 2, IIf([tipodocumento]="cnpj",2,1), tbl_rot_vendas.Cod_venda, tbl_rot_vendas.VendaFinalizada_vendas, Cs_TotalPorVenda.Totalporvenda, 2
HAVING (((tbl_rot_vendas.cod_venda)=[Formulários]![Frm_MenuPrinc]![VarCodVenda]));
