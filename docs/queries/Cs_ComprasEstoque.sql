SELECT tbl_cad_compras.cod_compras, tbl_cad_compras.DtEmissao_compras, tbl_cad_compras.Cod_Fornecedor, tbl_cad_compras.NumeroPedido_compras, tbl_cad_prodserv.Cod_ProdServ, tbl_cad_prodserv.Nome_prodServ AS [Nome do Produto], IIf(Sum([Quantidade_ComprasDet]),Sum([Quantidade_ComprasDet]),0) AS QtdComprada, Tbl_cad_comprasDetalhadas.ValorUnitario_comprasDet AS [Valor Unit], [QtdComprada]*[ValorUnitario_comprasDet] AS [Valor Total], tbl_cad_compras.ListaComprar_compras, tbl_cad_compras.LancarEmContasaPagar_compras
FROM tbl_cad_compras RIGHT JOIN (Tbl_cad_comprasDetalhadas RIGHT JOIN tbl_cad_prodserv ON Tbl_cad_comprasDetalhadas.Cod_ProdServ = tbl_cad_prodserv.Cod_ProdServ) ON tbl_cad_compras.cod_compras = Tbl_cad_comprasDetalhadas.Cod_compras
GROUP BY tbl_cad_compras.cod_compras, tbl_cad_compras.DtEmissao_compras, tbl_cad_compras.Cod_Fornecedor, tbl_cad_compras.NumeroPedido_compras, tbl_cad_prodserv.Cod_ProdServ, tbl_cad_prodserv.Nome_prodServ, Tbl_cad_comprasDetalhadas.ValorUnitario_comprasDet, tbl_cad_compras.ListaComprar_compras, tbl_cad_compras.LancarEmContasaPagar_compras
HAVING (((tbl_cad_compras.cod_compras) Is Not Null) And ((tbl_cad_compras.DtEmissao_compras) Between DLookUp("data_receitasprevistas","tbl_fluxo_ReceitasPrevistas") And Formul√°rios!Frm_MenuPrinc!txtDataEst+1) And ((tbl_cad_compras.ListaComprar_compras)=No));
