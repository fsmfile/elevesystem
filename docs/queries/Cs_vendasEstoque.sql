SELECT tbl_cad_prodserv.Cod_ProdServ, IIf(Sum([Quantidade_VendasDet]),Sum([Quantidade_VendasDet]),0) AS VendasEstoque, tbl_rot_vendas.Cod_formaRetiradaEstoque, [Dt_Hr_venda] Between DLookUp("data_receitasprevistas","tbl_fluxo_ReceitasPrevistas") And [Formulários]![Frm_MenuPrinc]![txtDataEst]+1 AS Expr1
FROM (tbl_cad_prodserv RIGHT JOIN tbl_rot_vendasDetalhadas ON tbl_cad_prodserv.Cod_ProdServ = tbl_rot_vendasDetalhadas.Cod_produto) RIGHT JOIN tbl_rot_vendas ON tbl_rot_vendasDetalhadas.Cod_venda = tbl_rot_vendas.Cod_venda
GROUP BY tbl_cad_prodserv.Cod_ProdServ, tbl_rot_vendas.Cod_formaRetiradaEstoque, [Dt_Hr_venda] Between DLookUp("data_receitasprevistas","tbl_fluxo_ReceitasPrevistas") And [Formulários]![Frm_MenuPrinc]![txtDataEst]+1, tbl_rot_vendas.VendaFinalizada_vendas, tbl_cad_prodserv.ProdutoAtivo_prodServ
HAVING (((tbl_rot_vendas.Cod_formaRetiradaEstoque)=1) AND (([Dt_Hr_venda] Between DLookUp("data_receitasprevistas","tbl_fluxo_ReceitasPrevistas") And [Formulários]![Frm_MenuPrinc]![txtDataEst]+1)=True) AND ((tbl_rot_vendas.VendaFinalizada_vendas)=Yes) AND ((tbl_cad_prodserv.ProdutoAtivo_prodServ)=Yes));
