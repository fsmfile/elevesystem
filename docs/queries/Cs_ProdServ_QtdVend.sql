SELECT tbl_cad_prodserv.Cod_ProdServ AS CodProd, tbl_cad_prodserv.Grupo_prodServ, tbl_cad_prodserv.SubGrupo_prodserv, tbl_cad_prodserv.nome_prodserv AS Produto, Sum(tbl_rot_vendasDetalhadas.Quantidade_VendasDet) AS Qtd, DateSerial(Year([Dt_Hr_venda]),Month([Dt_Hr_venda]),Day([Dt_Hr_venda])) AS Data, tbl_cad_clientes.Cod_cliente, tbl_cad_clientes.NomeRazaoSocial_Cliente, tbl_cad_clientes.Apelido_cliente
FROM ((tbl_rot_vendasDetalhadas LEFT JOIN tbl_cad_prodserv ON tbl_rot_vendasDetalhadas.Cod_produto = tbl_cad_prodserv.Cod_ProdServ) RIGHT JOIN tbl_rot_vendas ON tbl_rot_vendasDetalhadas.Cod_venda = tbl_rot_vendas.Cod_venda) LEFT JOIN tbl_cad_clientes ON tbl_rot_vendas.Cod_cliente = tbl_cad_clientes.Cod_cliente
GROUP BY tbl_cad_prodserv.Cod_ProdServ, tbl_cad_prodserv.Grupo_prodServ, tbl_cad_prodserv.SubGrupo_prodserv, tbl_cad_prodserv.nome_prodserv, DateSerial(Year([Dt_Hr_venda]),Month([Dt_Hr_venda]),Day([Dt_Hr_venda])), tbl_cad_clientes.Cod_cliente, tbl_cad_clientes.NomeRazaoSocial_Cliente, tbl_cad_clientes.Apelido_cliente, tbl_rot_vendas.Cod_formaRetiradaEstoque, tbl_rot_vendas.VendaFinalizada_vendas
HAVING (((tbl_cad_prodserv.Cod_ProdServ) Is Not Null) AND ((tbl_rot_vendas.Cod_formaRetiradaEstoque)=1) AND ((tbl_rot_vendas.VendaFinalizada_vendas)=Yes))
ORDER BY Sum(tbl_rot_vendasDetalhadas.Quantidade_VendasDet) DESC;
